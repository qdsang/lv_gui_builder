var e=Object.defineProperty,t=(t,a,n)=>(((t,a,n)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n})(t,"symbol"!=typeof a?a+"":a,n),n);/* empty css                  *//* empty css                    *//* empty css                  */import{d as a,J as n,r as i,aH as s,o as r,c as o,m as l,a as h,w as u,b as d,aE as _,l as c,A as p,z as m,av as C,ai as g,U as v,V as w,Y as A,a5 as F,E as R,$ as b}from"./index.30a0e171.js";import{_ as f}from"./_plugin-vue_export-helper.cdc0426e.js";var O=(e=>(e.CF_TRUE_COLOR="CF_TRUE_COLOR",e.CF_TRUE_COLOR_ALPHA="CF_TRUE_COLOR_ALPHA",e.CF_TRUE_COLOR_CHROMA="CF_TRUE_COLOR_CHROMA",e.CF_INDEXED_1_BIT="CF_INDEXED_1_BIT",e.CF_INDEXED_2_BIT="CF_INDEXED_2_BIT",e.CF_INDEXED_4_BIT="CF_INDEXED_4_BIT",e.CF_INDEXED_8_BIT="CF_INDEXED_8_BIT",e.CF_ALPHA_1_BIT="CF_ALPHA_1_BIT",e.CF_ALPHA_2_BIT="CF_ALPHA_2_BIT",e.CF_ALPHA_4_BIT="CF_ALPHA_4_BIT",e.CF_ALPHA_8_BIT="CF_ALPHA_8_BIT",e.CF_RAW="CF_RAW",e.CF_RAW_ALPHA="CF_RAW_ALPHA",e.CF_RAW_CHROMA="CF_RAW_CHROMA",e.CF_RGB565A8="CF_RGB565A8",e))(O||{}),T=(e=>(e.C="C",e.BIN="BIN",e.PYTHON="PYTHON",e))(T||{});const y={isTrueColor:e=>["CF_TRUE_COLOR","CF_TRUE_COLOR_ALPHA","CF_TRUE_COLOR_CHROMA"].includes(e)};class E{static rgb565(e,t,a){return(248&e)<<8|(252&t)<<3|a>>3}static rgb888(e,t,a){return e<<16|t<<8|a}static rgba8888(e,t,a,n){return n<<24|e<<16|t<<8|a}}class L{constructor(e,a){t(this,"canvas"),t(this,"ctx"),t(this,"imageData"),t(this,"width"),t(this,"height"),t(this,"options"),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.width=a.overrideWidth||e.width,this.height=a.overrideHeight||e.height,this.canvas.width=this.width,this.canvas.height=this.height,this.ctx.drawImage(e,0,0,this.width,this.height),this.imageData=this.ctx.getImageData(0,0,this.width,this.height),this.options=a}convertToC(){const e=this.processPixels();return`${this.generateHeaderComment()}\n${this.generateDataArray(e)}\n${this.generateDescriptor()}`}convertToBinary(){const e=this.processPixels(),t=this.generateBinaryHeader(),a=new Uint8Array(t.length+e.length);return a.set(t),a.set(e,t.length),a}convertToPython(){const e=this.processPixels();return`${this.generatePythonHeaderComment()}\n${this.generatePythonDataArray(e)}\n${this.generatePythonDescriptor()}`}processPixels(){const{cf:e,dith:t}=this.options,a=this.imageData.data,n=[];for(let i=0;i<a.length;i+=4){const t=a[i],s=a[i+1],r=a[i+2],o=a[i+3];if(y.isTrueColor(e))switch(e){case O.CF_TRUE_COLOR:n.push(E.rgb565(t,s,r));break;case O.CF_TRUE_COLOR_ALPHA:n.push(E.rgba8888(t,s,r,o))}}return new Uint8Array(n)}generateHeaderComment(){return`/*\n * Generated by LVGL Image Converter\n * Width: ${this.width}\n * Height: ${this.height}\n * Color Format: ${this.options.cf}\n */`}generatePythonHeaderComment(){return`"""\nGenerated by LVGL Image Converter\nWidth: ${this.width}\nHeight: ${this.height}\nColor Format: ${this.options.cf}\n"""\n\nimport lvgl as lv\n`}generateDataArray(e){const t=[];t.push(`const uint8_t ${this.options.outName}_map[] = {`);for(let a=0;a<e.length;a+=16){const n=Array.from(e.slice(a,a+16)).map(e=>"0x"+e.toString(16).padStart(2,"0")).join(", ");t.push(`    ${n}${a+16<e.length?",":""}`)}return t.push("};"),t.join("\n")}generatePythonDataArray(e){const t=[];t.push(`${this.options.outName}_map = bytes([`);for(let a=0;a<e.length;a+=16){const n=Array.from(e.slice(a,a+16)).map(e=>"0x"+e.toString(16).padStart(2,"0")).join(", ");t.push(`    ${n}${a+16<e.length?",":""}`)}return t.push("])"),t.join("\n")}generateDescriptor(){return`\nconst lv_img_dsc_t ${this.options.outName} = {\n    .header.cf = ${this.options.cf},\n    .header.always_zero = 0,\n    .header.reserved = 0,\n    .header.w = ${this.width},\n    .header.h = ${this.height},\n    .data_size = ${this.width*this.height*this.getBytesPerPixel()},\n    .data = ${this.options.outName}_map,\n};`}generatePythonDescriptor(){return`\n${this.options.outName} = lv.img_dsc_t({\n    'header': {\n        'cf': lv.img.CF.${this.options.cf},\n        'always_zero': 0,\n        'reserved': 0,\n        'w': ${this.width},\n        'h': ${this.height}\n    },\n    'data_size': ${this.width*this.height*this.getBytesPerPixel()},\n    'data': ${this.options.outName}_map\n})`}generateBinaryHeader(){const e=new Uint8Array(8),t=new DataView(e.buffer);return t.setUint32(0,1280722756,!this.options.swapEndian),t.setUint16(4,this.width,!this.options.swapEndian),t.setUint16(6,this.height,!this.options.swapEndian),e}getBytesPerPixel(){switch(this.options.cf){case O.CF_TRUE_COLOR:return 2;case O.CF_TRUE_COLOR_ALPHA:return 4;default:return 1}}convert(){switch(this.options.outputFormat){case T.C:return this.convertToC();case T.PYTHON:return this.convertToPython();case T.BIN:return this.convertToBinary();default:throw new Error("Unsupported output format")}}}const P={class:"image-converter"},I={class:"converter-container"},B={key:0,class:"preview-section"},H={class:"preview-container"},U=["src"],x={key:0,class:"image-info"},$=f(a({__name:"index",setup(e){const t=n(null),a=n(""),f=n(null),y=i({cf:O.CF_TRUE_COLOR,dith:!1,outputFormat:T.C,binaryFormat:O.CF_TRUE_COLOR,swapEndian:!1,outName:"img_converted",colorDepth:"16"}),E=s(()=>[O.CF_TRUE_COLOR,O.CF_TRUE_COLOR_ALPHA].includes(y.cf)),$=e=>{t.value=e.raw,a.value=URL.createObjectURL(e.raw);const n=new Image;n.onload=()=>{f.value={width:n.width,height:n.height,size:e.raw.size}},n.src=a.value},D=async()=>{try{if(!t.value)return void C.warning("请先选择图片");const e=new Image,n=new Promise((t,a)=>{e.onload=()=>t(e),e.onerror=a});e.src=a.value,await n;const i=await async function(e,t){return new L(e,t).convert()}(e,{cf:y.cf,dith:y.dith,outputFormat:y.outputFormat,binaryFormat:y.binaryFormat,swapEndian:y.swapEndian,outName:y.outName}),s=e=>{switch(e){case T.C:return"c";case T.PYTHON:return"py";case T.BIN:return"bin";default:return"txt"}},r=new Blob([i],{type:y.outputFormat===T.BIN?"application/octet-stream":"text/plain"}),o=URL.createObjectURL(r),l=document.createElement("a");l.href=o,l.download=`${y.outName}.${s(y.outputFormat)}`,l.click(),URL.revokeObjectURL(o),C.success("图片转换成功")}catch(e){C.error("图片转换失败: "+e.message)}};return(e,n)=>{const i=g,s=v,C=w,O=A,L=F,N=R,V=b;return r(),o("div",P,[l("div",I,[h(i,{class:"image-upload",drag:"","auto-upload":!1,"on-change":$,accept:"image/*"},{default:u(()=>n[4]||(n[4]=[l("i",{class:"el-icon-upload"},null,-1),l("div",{class:"el-upload__text"},[d("拖拽图片到此处或 "),l("em",null,"点击上传")],-1)])),_:1,__:[4]}),h(V,{model:y,"label-width":"120px",class:"settings-form"},{default:u(()=>[h(O,{label:"颜色格式"},{default:u(()=>[h(C,{modelValue:y.cf,"onUpdate:modelValue":n[0]||(n[0]=e=>y.cf=e)},{default:u(()=>[h(s,{label:"True Color",value:"true_color"}),h(s,{label:"True Color Alpha",value:"true_color_alpha"}),h(s,{label:"Indexed 1 (1 bit)",value:"indexed_1"}),h(s,{label:"Indexed 2 (2 bit)",value:"indexed_2"}),h(s,{label:"Indexed 4 (4 bit)",value:"indexed_4"}),h(s,{label:"Indexed 8 (8 bit)",value:"indexed_8"})]),_:1},8,["modelValue"])]),_:1}),h(O,{label:"抖动"},{default:u(()=>[h(L,{modelValue:y.dith,"onUpdate:modelValue":n[1]||(n[1]=e=>y.dith=e)},null,8,["modelValue"])]),_:1}),h(O,{label:"输出格式"},{default:u(()=>[h(C,{modelValue:y.outputFormat,"onUpdate:modelValue":n[2]||(n[2]=e=>y.outputFormat=e)},{default:u(()=>[h(s,{label:"C 数组",value:_(T).C},null,8,["value"]),h(s,{label:"Python 数组",value:_(T).PYTHON},null,8,["value"]),h(s,{label:"二进制文件",value:_(T).BIN},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),E.value?(r(),c(O,{key:0,label:"颜色深度"},{default:u(()=>[h(C,{modelValue:y.colorDepth,"onUpdate:modelValue":n[3]||(n[3]=e=>y.colorDepth=e)},{default:u(()=>[h(s,{label:"16 bit (RGB565)",value:"16"}),h(s,{label:"24 bit (RGB888)",value:"24"}),h(s,{label:"32 bit (ARGB8888)",value:"32"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),h(O,null,{default:u(()=>[h(N,{type:"primary",onClick:D,disabled:!t.value},{default:u(()=>n[5]||(n[5]=[d(" 转换图片 ",-1)])),_:1,__:[5]},8,["disabled"])]),_:1})]),_:1},8,["model"]),a.value?(r(),o("div",B,[n[6]||(n[6]=l("h3",null,"预览",-1)),l("div",H,[l("img",{src:a.value,alt:"Preview"},null,8,U),f.value?(r(),o("div",x,[l("p",null,"尺寸: "+m(f.value.width)+" x "+m(f.value.height)+" px",1),l("p",null,"文件大小: "+m((j=f.value.size,j<1024?j+" B":j<1048576?(j/1024).toFixed(2)+" KB":(j/1048576).toFixed(2)+" MB")),1)])):p("",!0)])])):p("",!0)])]);var j}}}),[["__scopeId","data-v-2935fade"]]);export{$ as default};
